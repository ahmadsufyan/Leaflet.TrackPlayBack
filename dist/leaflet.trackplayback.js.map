{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external {\"root\":\"L\",\"commonjs\":\"leaflet\",\"commonjs2\":\"leaflet\",\"amd\":\"leaflet\"}","webpack:///./src/leaflet.trackplayback/util.js","webpack:///./src/leaflet.trackplayback/track.js","webpack:///./src/leaflet.trackplayback/trackcontroller.js","webpack:///./src/leaflet.trackplayback/clock.js","webpack:///./src/leaflet.trackplayback/tracklayer.js","webpack:///./src/leaflet.trackplayback/draw.js","webpack:///./src/leaflet.trackplayback/trackplayback.js","webpack:///./src/leaflet.trackplayback/index.js"],"names":["root","factory","exports","module","require","define","amd","a","i","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isArray","arr","Array","toString","Track","external_root_L_commonjs_leaflet_commonjs2_leaflet_amd_leaflet_default","Class","extend","initialize","trackData","options","setOptions","this","forEach","item","isOrigin","_trackPoints","_timeTick","_update","addTrackPoint","trackPoint","len","length","_addTrackPoint","getTimes","times","push","time","getStartTrackPoint","getEndTrackPoint","getTrackPointByTime","_getCalculateTrackPointByTime","endpoint","startPt","endPt","left","right","parseInt","t0","t1","p0","p1","point","lng","lat","distanceTo","v","sinx","y","cosx","x","step","dir","Math","PI","asin","undefined","getTrackPointsBeforeTime","tpoints","_sortTrackPointsByTime","_updatetimeTick","j","tmp","TrackController","tracks","draw","_tracks","addTrack","_draw","_updateTime","getMinTime","_minTime","getMaxTime","_maxTime","track","Error","setVisibility","visibleIndexes","_visibileIndexes","drawTracksByTime","clear","canAdd","indexOf","tps","drawTrack","drawMarker","stime","etime","Clock","includes","Evented","Mixin","Events","speed","maxSpeed","trackController","_trackController","_endTime","_curTime","_speed","_maxSpeed","_intervalID","_lastFpsUpdateTime","start","Util","requestAnimFrame","_tick","stop","cancelAnimFrame","rePlaying","slowSpeed","quickSpeed","getSpeed","getCurTime","getStartTime","getEndTime","isPlaying","setCursor","fire","setSpeed","_caculatefpsTime","now","Date","isPause","stepTime","pow","TrackLayer","Renderer","padding","onAdd","map","_container","DomUtil","getPane","pane","appendChild","_ctx","getContext","onRemove","remove","getContainer","getBounds","_bounds","_map","_animatingZoom","b","container","size","getSize","Browser","retina","setPosition","min","width","height","style","scale","translate","Draw","trackPointOptions","isDraw","useCanvas","stroke","color","fill","fillColor","opacity","radius","trackLineOptions","weight","targetOptions","useImg","imgUrl","showText","toolTipOptions","offset","direction","permanent","_showTrackPoint","_showTrackLine","on","_onmousemoveEvt","_trackLayer","addTo","_trackLayerUpdate","_canvas","_bufferTracks","_trackPointFeatureGroup","featureGroup","_targetImg","index","Image","onerror","src","img","onload","update","trackpoints","_drawTrack","_drawMarker","showTrackPoint","hideTrackPoint","showTrackLine","hideTrackLine","off","hasLayer","removeLayer","_clearLayer","element","e","layerPoint","leni","tpoint","_getLayerPoint","_opentoolTip","_tooltip","cursor","trackpoint","latlng","latLng","tooltip","setLatLng","setContent","_getTooltipText","_drawTrackLine","_drawTrackPointsCanvas","_drawTrackPointsSvg","targetPoint","_drawShipImage","_drawShipCanvas","_drawtxt","tp0","save","beginPath","moveTo","tpi","lineTo","globalAlpha","strokeStyle","lineWidth","fillStyle","restore","latLngToLayerPoint","arc","cricleMarker","circleMarker","bindTooltip","addLayer","text","font","textAlign","textBaseline","fillText","rotate","w","h","dh","closePath","drawImage","targetobj","content","info","join","bounds","clearRect","clearLayers","[object Object]","TrackPlayBack","data","drawOptions","_initTracks","clock","clockOptions","dispose","trackplayback"],"mappings":"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","file":"leaflet.trackplayback.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"leaflet\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"leaflet\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"leaflet\")) : factory(root[\"L\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","export function isArray (arr) {\r\n  return Array.isArray ? Array.isArray(arr) : Object.prototype.toString.call(arr) === '[object Array]'\r\n}\r\n","import L from 'leaflet'\r\n\r\nimport {\r\n  isArray\r\n} from './util'\r\n\r\n/**\r\n * 轨迹类\r\n */\r\nexport const Track = L.Class.extend({\r\n\r\n  initialize: function (trackData = [], options) {\r\n    L.setOptions(this, options)\r\n\r\n    trackData.forEach(item => {\r\n      // 添加 isOrigin 字段用来标识是否是原始采样点，与插值点区分开\r\n      item.isOrigin = true\r\n    })\r\n    this._trackPoints = trackData\r\n    this._timeTick = {}\r\n    this._update()\r\n  },\r\n\r\n  addTrackPoint: function (trackPoint) {\r\n    if (isArray(trackPoint)) {\r\n      for (let i = 0, len = trackPoint.length; i < len; i++) {\r\n        this.addTrackPoint(trackPoint[i])\r\n      }\r\n    }\r\n    this._addTrackPoint(trackPoint)\r\n  },\r\n\r\n  getTimes: function () {\r\n    let times = []\r\n    for (let i = 0, len = this._trackPoints.length; i < len; i++) {\r\n      times.push(this._trackPoints[i].time)\r\n    }\r\n    return times\r\n  },\r\n\r\n  getStartTrackPoint: function () {\r\n    return this._trackPoints[0]\r\n  },\r\n\r\n  getEndTrackPoint: function () {\r\n    return this._trackPoints[this._trackPoints.length - 1]\r\n  },\r\n\r\n  getTrackPointByTime: function (time) {\r\n    return this._trackPoints[this._timeTick[time]]\r\n  },\r\n\r\n  _getCalculateTrackPointByTime: function (time) {\r\n    // 先判断最后一个点是否为原始点\r\n    let endpoint = this.getTrackPointByTime(time)\r\n    let startPt = this.getStartTrackPoint()\r\n    let endPt = this.getEndTrackPoint()\r\n    let times = this.getTimes()\r\n    if (time < startPt.time || time > endPt.time) return\r\n    let left = 0\r\n    let right = times.length - 1\r\n    let n\r\n    // 处理只有一个点情况\r\n    if (left === right) {\r\n      return endpoint\r\n    }\r\n    // 通过【二分查找】法查出当前时间所在的时间区间\r\n    while (right - left !== 1) {\r\n      n = parseInt((left + right) / 2)\r\n      if (time > times[n]) left = n\r\n      else right = n\r\n    }\r\n\r\n    let t0 = times[left]\r\n    let t1 = times[right]\r\n    let t = time\r\n    let p0 = this.getTrackPointByTime(t0)\r\n    let p1 = this.getTrackPointByTime(t1)\r\n    startPt = L.point(p0.lng, p0.lat)\r\n    endPt = L.point(p1.lng, p1.lat)\r\n    let s = startPt.distanceTo(endPt)\r\n    // 不同时间在同一个点情形\r\n    if (s <= 0) {\r\n      endpoint = p1\r\n      return endpoint\r\n    }\r\n    // 假设目标在两点间做匀速直线运动\r\n    // 求解速度向量，并计算时间 t 目标所在位置\r\n    let v = s / (t1 - t0)\r\n    let sinx = (endPt.y - startPt.y) / s\r\n    let cosx = (endPt.x - startPt.x) / s\r\n    let step = v * (t - t0)\r\n    let x = startPt.x + step * cosx\r\n    let y = startPt.y + step * sinx\r\n    // 求目标的运动方向，0-360度\r\n    let dir = endPt.x >= startPt.x ? (Math.PI * 0.5 - Math.asin(sinx)) * 180 / Math.PI : (Math.PI * 1.5 + Math.asin(sinx)) * 180 / Math.PI\r\n\r\n    if (endpoint) {\r\n      if (endpoint.dir === undefined) {\r\n        endpoint.dir = dir\r\n      }\r\n    } else {\r\n      endpoint = {\r\n        lng: x,\r\n        lat: y,\r\n        dir: endPt.dir || dir,\r\n        isOrigin: false,\r\n        time: time\r\n      }\r\n    }\r\n    return endpoint\r\n  },\r\n\r\n  // 获取某个时间点之前走过的轨迹\r\n  getTrackPointsBeforeTime: function (time) {\r\n    let tpoints = []\r\n    for (let i = 0, len = this._trackPoints.length; i < len; i++) {\r\n      if (this._trackPoints[i].time < time) {\r\n        tpoints.push(this._trackPoints[i])\r\n      }\r\n    }\r\n    // 获取最后一个点，根据时间线性插值而来\r\n    let endPt = this._getCalculateTrackPointByTime(time)\r\n    if (endPt) {\r\n      tpoints.push(endPt)\r\n    }\r\n    return tpoints\r\n  },\r\n\r\n  _addTrackPoint: function (trackPoint) {\r\n    trackPoint.isOrigin = true\r\n    this._trackPoints.push(trackPoint)\r\n    this._update()\r\n  },\r\n\r\n  _update: function () {\r\n    this._sortTrackPointsByTime()\r\n    this._updatetimeTick()\r\n  },\r\n\r\n  // 轨迹点按时间排序 【冒泡排序】\r\n  _sortTrackPointsByTime: function () {\r\n    let len = this._trackPoints.length\r\n    for (let i = 0; i < len; i++) {\r\n      for (let j = 0; j < len - 1 - i; j++) {\r\n        if (this._trackPoints[j].time > this._trackPoints[j + 1].time) {\r\n          let tmp = this._trackPoints[j + 1]\r\n          this._trackPoints[j + 1] = this._trackPoints[j]\r\n          this._trackPoints[j] = tmp\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  // 为轨迹点建立时间索引，优化查找性能\r\n  _updatetimeTick: function () {\r\n    this._timeTick = {}\r\n    for (let i = 0, len = this._trackPoints.length; i < len; i++) {\r\n      this._timeTick[this._trackPoints[i].time] = i\r\n    }\r\n  }\r\n})\r\n\r\nexport const track = function (trackData, options) {\r\n  return new Track(trackData, options)\r\n}\r\n","import L from 'leaflet'\r\n\r\nimport { isArray } from './util'\r\nimport { Track } from './track'\r\n\r\n/**\r\n * 控制器类\r\n * 控制轨迹和绘制\r\n */\r\nexport const TrackController = L.Class.extend({\r\n  initialize: function (tracks = [], draw, options) {\r\n    L.setOptions(this, options)\r\n\r\n    this._tracks = []\r\n    this.addTrack(tracks)\r\n\r\n    this._draw = draw\r\n\r\n    this._updateTime()\r\n  },\r\n\r\n  getMinTime: function () {\r\n    return this._minTime\r\n  },\r\n\r\n  getMaxTime: function () {\r\n    return this._maxTime\r\n  },\r\n\r\n  addTrack: function (track) {\r\n    if (isArray(track)) {\r\n      for (let i = 0, len = track.length; i < len; i++) {\r\n        this.addTrack(track[i])\r\n      }\r\n    } else if (track instanceof Track) {\r\n      this._tracks.push(track)\r\n      this._updateTime()\r\n    } else {\r\n      throw new Error(\r\n        'tracks must be an instance of `Track` or an array of `Track` instance!'\r\n      )\r\n    }\r\n  },\r\n\r\n  setVisibility: function (visibleIndexes) {\r\n    this._visibileIndexes = visibleIndexes\r\n  },\r\n\r\n  drawTracksByTime: function (time) {\r\n    this._draw.clear()\r\n    for (let i = 0, len = this._tracks.length; i < len; i++) {\r\n      let canAdd =\r\n        this._visibileIndexes === null || this._visibileIndexes === undefined\r\n      if (!canAdd) {\r\n        canAdd = this._visibileIndexes.indexOf(i) !== -1\r\n      }\r\n      if (canAdd) {\r\n        let track = this._tracks[i]\r\n        let tps = track.getTrackPointsBeforeTime(time)\r\n        if (tps && tps.length) this._draw.drawTrack(tps, i)\r\n      }\r\n    }\r\n    for (let i = 0, len = this._tracks.length; i < len; i++) {\r\n      let canAdd =\r\n        this._visibileIndexes === null || this._visibileIndexes === undefined\r\n      if (!canAdd) {\r\n        canAdd = this._visibileIndexes.indexOf(i) !== -1\r\n      }\r\n      if (canAdd) {\r\n        let track = this._tracks[i]\r\n        let tps = track.getTrackPointsBeforeTime(time)\r\n        if (tps && tps.length) this._draw.drawMarker(tps, i)\r\n      }\r\n    }\r\n  },\r\n\r\n  _updateTime: function () {\r\n    this._minTime = this._tracks[0].getStartTrackPoint().time\r\n    this._maxTime = this._tracks[0].getEndTrackPoint().time\r\n    for (let i = 0, len = this._tracks.length; i < len; i++) {\r\n      let stime = this._tracks[i].getStartTrackPoint().time\r\n      let etime = this._tracks[i].getEndTrackPoint().time\r\n      if (stime < this._minTime) {\r\n        this._minTime = stime\r\n      }\r\n      if (etime > this._maxTime) {\r\n        this._maxTime = etime\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nexport const trackController = function (tracks, draw, options) {\r\n  return new TrackController(tracks, draw, options)\r\n}\r\n","import L from 'leaflet'\r\n/**\r\n * 时钟类，控制轨迹播放动画\r\n */\r\nexport const Clock = L.Class.extend({\r\n\r\n  includes: L.Evented.prototype || L.Mixin.Events,\r\n\r\n  options: {\r\n    // 播放速度\r\n    // 计算方法 fpstime * Math.pow(2, this._speed - 1)\r\n    speed: 12,\r\n    // 最大播放速度\r\n    maxSpeed: 65\r\n  },\r\n\r\n  initialize: function (trackController, options) {\r\n    L.setOptions(this, options)\r\n\r\n    this._trackController = trackController\r\n    this._endTime = this._trackController.getMaxTime()\r\n    this._curTime = this._trackController.getMinTime()\r\n    this._speed = this.options.speed\r\n    this._maxSpeed = this.options.maxSpeed\r\n    this._intervalID = null\r\n    this._lastFpsUpdateTime = 0\r\n  },\r\n\r\n  start: function () {\r\n    if (this._intervalID) return\r\n    this._intervalID = L.Util.requestAnimFrame(this._tick, this)\r\n  },\r\n\r\n  stop: function () {\r\n    if (!this._intervalID) return\r\n    L.Util.cancelAnimFrame(this._intervalID)\r\n    this._intervalID = null\r\n    this._lastFpsUpdateTime = 0\r\n  },\r\n\r\n  rePlaying: function () {\r\n    this.stop()\r\n    this._curTime = this._trackController.getMinTime()\r\n    this.start()\r\n  },\r\n\r\n  slowSpeed: function () {\r\n    this._speed = this._speed <= 1 ? this._speed : this._speed - 1\r\n    if (this._intervalID) {\r\n      this.stop()\r\n      this.start()\r\n    }\r\n  },\r\n\r\n  quickSpeed: function () {\r\n    this._speed = this._speed >= this._maxSpeed ? this._speed : this._speed + 1\r\n    if (this._intervalID) {\r\n      this.stop()\r\n      this.start()\r\n    }\r\n  },\r\n\r\n  getSpeed: function () {\r\n    return this._speed\r\n  },\r\n\r\n  getCurTime: function () {\r\n    return this._curTime\r\n  },\r\n\r\n  getStartTime: function () {\r\n    return this._trackController.getMinTime()\r\n  },\r\n\r\n  getEndTime: function () {\r\n    return this._trackController.getMaxTime()\r\n  },\r\n\r\n  isPlaying: function () {\r\n    return !!this._intervalID\r\n  },\r\n\r\n  setCursor: function (time) {\r\n    this._curTime = time\r\n    this._trackController.drawTracksByTime(this._curTime)\r\n    this.fire('tick', {\r\n      time: this._curTime\r\n    })\r\n  },\r\n\r\n  setVisibility: function (visibleIndexes) {\r\n    this._trackController.setVisibility(visibleIndexes)\r\n    if (this._intervalID) return\r\n    this._trackController.drawTracksByTime(this._curTime)\r\n  },\r\n\r\n  setSpeed: function (speed) {\r\n    this._speed = speed\r\n    if (this._intervalID) {\r\n      this.stop()\r\n      this.start()\r\n    }\r\n  },\r\n\r\n  // 计算两帧时间间隔，单位：秒\r\n  _caculatefpsTime: function (now) {\r\n    let time\r\n    if (this._lastFpsUpdateTime === 0) {\r\n      time = 0\r\n    } else {\r\n      time = now - this._lastFpsUpdateTime\r\n    }\r\n    this._lastFpsUpdateTime = now\r\n    // 将毫秒转换成秒\r\n    time = time / 1000\r\n    return time\r\n  },\r\n\r\n  _tick: function () {\r\n    let now = +new Date()\r\n    let fpstime = this._caculatefpsTime(now)\r\n    let isPause = false\r\n    let stepTime = fpstime * Math.pow(2, this._speed - 1)\r\n    this._curTime += stepTime\r\n    if (this._curTime >= this._endTime) {\r\n      this._curTime = this._endTime\r\n      isPause = true\r\n    }\r\n    this._trackController.drawTracksByTime(this._curTime)\r\n    this.fire('tick', {\r\n      time: this._curTime\r\n    })\r\n    if (!isPause) this._intervalID = L.Util.requestAnimFrame(this._tick, this)\r\n  }\r\n})\r\n\r\nexport const clock = function (trackController, options) {\r\n  return new Clock(trackController, options)\r\n}\r\n","import L from 'leaflet'\r\n\r\n/**\r\n * 轨迹图层\r\n */\r\nexport const TrackLayer = L.Renderer.extend({\r\n\r\n  initialize: function (options) {\r\n    L.Renderer.prototype.initialize.call(this, options)\r\n    this.options.padding = 0.1\r\n  },\r\n\r\n  onAdd: function (map) {\r\n    this._container = L.DomUtil.create('canvas', 'leaflet-zoom-animated')\r\n\r\n    var pane = map.getPane(this.options.pane)\r\n    pane.appendChild(this._container)\r\n\r\n    this._ctx = this._container.getContext('2d')\r\n\r\n    this._update()\r\n  },\r\n\r\n  onRemove: function (map) {\r\n    L.DomUtil.remove(this._container)\r\n  },\r\n\r\n  getContainer: function () {\r\n    return this._container\r\n  },\r\n\r\n  getBounds: function () {\r\n    return this._bounds\r\n  },\r\n\r\n  _update: function () {\r\n    if (this._map._animatingZoom && this._bounds) {\r\n      return\r\n    }\r\n\r\n    L.Renderer.prototype._update.call(this)\r\n\r\n    var b = this._bounds\r\n\r\n    var container = this._container\r\n\r\n    var size = b.getSize()\r\n\r\n    var m = L.Browser.retina ? 2 : 1\r\n\r\n    L.DomUtil.setPosition(container, b.min)\r\n\r\n    // set canvas size (also clearing it); use double size on retina\r\n    container.width = m * size.x\r\n    container.height = m * size.y\r\n    container.style.width = size.x + 'px'\r\n    container.style.height = size.y + 'px'\r\n\r\n    if (L.Browser.retina) {\r\n      this._ctx.scale(2, 2)\r\n    }\r\n\r\n    // translate so we use the same path coordinates after canvas element moves\r\n    this._ctx.translate(-b.min.x, -b.min.y)\r\n\r\n    // Tell paths to redraw themselves\r\n    this.fire('update')\r\n  }\r\n})\r\n","import L from 'leaflet'\r\n\r\nimport { TrackLayer } from './tracklayer'\r\nimport { isArray } from './util'\r\n\r\n/**\r\n * 绘制类\r\n * 完成轨迹线、轨迹点、目标物的绘制工作\r\n */\r\nexport const Draw = L.Class.extend({\r\n  trackPointOptions: {\r\n    isDraw: false,\r\n    useCanvas: true,\r\n    stroke: false,\r\n    color: '#ef0300',\r\n    fill: true,\r\n    fillColor: '#ef0300',\r\n    opacity: 0.3,\r\n    radius: 4\r\n  },\r\n  trackLineOptions: {\r\n    isDraw: false,\r\n    stroke: true,\r\n    color: '#1C54E2', // stroke color\r\n    weight: 2,\r\n    fill: false,\r\n    fillColor: '#000',\r\n    opacity: 0.3\r\n  },\r\n  targetOptions: {\r\n    useImg: false,\r\n    imgUrl: '../../static/images/ship.png',\r\n    showText: false,\r\n    width: 8,\r\n    height: 18,\r\n    color: '#00f', // stroke color\r\n    fillColor: '#9FD12D'\r\n  },\r\n  toolTipOptions: {\r\n    offset: [0, 0],\r\n    direction: 'top',\r\n    permanent: false\r\n  },\r\n\r\n  initialize: function (map, options) {\r\n    L.extend(this.trackPointOptions, options.trackPointOptions)\r\n    L.extend(this.trackLineOptions, options.trackLineOptions)\r\n    L.extend(this.targetOptions, options.targetOptions)\r\n    L.extend(this.toolTipOptions, options.toolTipOptions)\r\n\r\n    this._showTrackPoint = this.trackPointOptions.isDraw\r\n    this._showTrackLine = this.trackLineOptions.isDraw\r\n\r\n    this._map = map\r\n    this._map.on('mousemove', this._onmousemoveEvt, this)\r\n\r\n    this._trackLayer = new TrackLayer().addTo(map)\r\n    this._trackLayer.on('update', this._trackLayerUpdate, this)\r\n\r\n    this._canvas = this._trackLayer.getContainer()\r\n    this._ctx = this._canvas.getContext('2d')\r\n\r\n    this._bufferTracks = []\r\n\r\n    if (!this.trackPointOptions.useCanvas) {\r\n      this._trackPointFeatureGroup = L.featureGroup([]).addTo(map)\r\n    }\r\n\r\n    // 目标如果使用图片，先加载图片\r\n    if (this.targetOptions.useImg) {\r\n      if (isArray(this.targetOptions.imgUrl)) {\r\n        this._targetImg = new Array(this.targetOptions.imgUrl.length)\r\n        this.targetOptions.imgUrl.forEach((imgUrl, index) => {\r\n          this._targetImg[index] = new Image()\r\n          this._targetImg[index].onerror = () => {\r\n            throw new Error('img load error!')\r\n          }\r\n          this._targetImg[index].src = imgUrl\r\n        })\r\n      } else {\r\n        const img = new Image()\r\n        img.onload = () => {\r\n          this._targetImg = img\r\n        }\r\n        img.onerror = () => {\r\n          throw new Error('img load error!')\r\n        }\r\n        img.src = this.targetOptions.imgUrl\r\n      }\r\n    }\r\n  },\r\n\r\n  update: function () {\r\n    this._trackLayerUpdate()\r\n  },\r\n\r\n  drawTrack: function (trackpoints, index) {\r\n    this._drawTrack(trackpoints, index)\r\n    this._drawMarker(trackpoints, index)\r\n  },\r\n\r\n  drawMarker: function (trackpoints, index) {\r\n    this._bufferTracks.push(trackpoints)\r\n    this._drawMarker(trackpoints, index)\r\n  },\r\n\r\n  showTrackPoint: function () {\r\n    this._showTrackPoint = true\r\n    this.update()\r\n  },\r\n\r\n  hideTrackPoint: function () {\r\n    this._showTrackPoint = false\r\n    this.update()\r\n  },\r\n\r\n  showTrackLine: function () {\r\n    this._showTrackLine = true\r\n    this.update()\r\n  },\r\n\r\n  hideTrackLine: function () {\r\n    this._showTrackLine = false\r\n    this.update()\r\n  },\r\n\r\n  remove: function () {\r\n    this._bufferTracks = []\r\n    this._trackLayer.off('update', this._trackLayerUpdate, this)\r\n    this._map.off('mousemove', this._onmousemoveEvt, this)\r\n    if (this._map.hasLayer(this._trackLayer)) {\r\n      this._map.removeLayer(this._trackLayer)\r\n    }\r\n    if (this._map.hasLayer(this._trackPointFeatureGroup)) {\r\n      this._map.removeLayer(this._trackPointFeatureGroup)\r\n    }\r\n  },\r\n\r\n  clear: function () {\r\n    this._clearLayer()\r\n    this._bufferTracks = []\r\n  },\r\n\r\n  _trackLayerUpdate: function () {\r\n    if (this._bufferTracks.length) {\r\n      this._clearLayer()\r\n      this._bufferTracks.forEach(\r\n        function (element, index) {\r\n          this._drawTrack(element, index)\r\n        }.bind(this)\r\n      )\r\n      this._bufferTracks.forEach(\r\n        function (element, index) {\r\n          this._drawMarker(element, index)\r\n        }.bind(this)\r\n      )\r\n    }\r\n  },\r\n\r\n  _onmousemoveEvt: function (e) {\r\n    if (!this._showTrackPoint) {\r\n      return\r\n    }\r\n    let point = e.layerPoint\r\n    if (this._bufferTracks.length) {\r\n      for (let i = 0, leni = this._bufferTracks.length; i < leni; i++) {\r\n        for (let j = 0, len = this._bufferTracks[i].length; j < len; j++) {\r\n          let tpoint = this._getLayerPoint(this._bufferTracks[i][j])\r\n          if (point.distanceTo(tpoint) <= this.trackPointOptions.radius) {\r\n            this._opentoolTip(this._bufferTracks[i][j])\r\n            return\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (this._map.hasLayer(this._tooltip)) {\r\n      this._map.removeLayer(this._tooltip)\r\n    }\r\n    this._canvas.style.cursor = 'pointer'\r\n  },\r\n\r\n  _opentoolTip: function (trackpoint) {\r\n    if (this._map.hasLayer(this._tooltip)) {\r\n      this._map.removeLayer(this._tooltip)\r\n    }\r\n    this._canvas.style.cursor = 'default'\r\n    let latlng = L.latLng(trackpoint.lat, trackpoint.lng)\r\n    let tooltip = (this._tooltip = L.tooltip(this.toolTipOptions))\r\n    tooltip.setLatLng(latlng)\r\n    tooltip.addTo(this._map)\r\n    tooltip.setContent(this._getTooltipText(trackpoint))\r\n  },\r\n\r\n  _drawTrack: function (trackpoints, index) {\r\n    // 画轨迹线\r\n    if (this._showTrackLine) {\r\n      this._drawTrackLine(trackpoints, index)\r\n    }\r\n    // 画经过的轨迹点\r\n    if (this._showTrackPoint) {\r\n      if (this.trackPointOptions.useCanvas) {\r\n        this._drawTrackPointsCanvas(trackpoints, index)\r\n      } else {\r\n        this._drawTrackPointsSvg(trackpoints)\r\n      }\r\n    }\r\n  },\r\n\r\n  _drawMarker: function (trackpoints, index) {\r\n    // 画船\r\n    let targetPoint = trackpoints[trackpoints.length - 1]\r\n    if (this.targetOptions.useImg && this._targetImg) {\r\n      this._drawShipImage(targetPoint, index)\r\n    } else {\r\n      this._drawShipCanvas(targetPoint, index)\r\n    }\r\n    // 画标注信息\r\n    if (this.targetOptions.showText) {\r\n      this._drawtxt(`航向：${parseInt(targetPoint.dir)}度`, targetPoint)\r\n    }\r\n  },\r\n\r\n  _drawTrackLine: function (trackpoints, index = 0) {\r\n    let options = this.trackLineOptions\r\n    let tp0 = this._getLayerPoint(trackpoints[0])\r\n    this._ctx.save()\r\n    this._ctx.beginPath()\r\n    // 画轨迹线\r\n    this._ctx.moveTo(tp0.x, tp0.y)\r\n    for (let i = 1, len = trackpoints.length; i < len; i++) {\r\n      let tpi = this._getLayerPoint(trackpoints[i])\r\n      this._ctx.lineTo(tpi.x, tpi.y)\r\n    }\r\n    this._ctx.globalAlpha = options.opacity\r\n    if (options.stroke) {\r\n      this._ctx.strokeStyle = isArray(options.color)\r\n        ? options.color[index]\r\n        : options.color\r\n      this._ctx.lineWidth = options.weight\r\n      this._ctx.stroke()\r\n    }\r\n    if (options.fill) {\r\n      this._ctx.fillStyle = isArray(options.fillColor)\r\n        ? options.fillColor[index]\r\n        : options.fillColor\r\n      this._ctx.fill()\r\n    }\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawTrackPointsCanvas: function (trackpoints, index = 0) {\r\n    let options = this.trackPointOptions\r\n    this._ctx.save()\r\n    for (let i = 0, len = trackpoints.length; i < len; i++) {\r\n      if (trackpoints[i].isOrigin) {\r\n        let latLng = L.latLng(trackpoints[i].lat, trackpoints[i].lng)\r\n        let radius = options.radius\r\n        let point = this._map.latLngToLayerPoint(latLng)\r\n        this._ctx.beginPath()\r\n        this._ctx.arc(point.x, point.y, radius, 0, Math.PI * 2, false)\r\n        this._ctx.globalAlpha = options.opacity\r\n        if (options.stroke) {\r\n          this._ctx.strokeStyle = isArray(options.color)\r\n            ? options.color[index]\r\n            : options.color\r\n          this._ctx.stroke()\r\n        }\r\n        if (options.fill) {\r\n          this._ctx.fillStyle = isArray(options.fillColor)\r\n            ? options.fillColor[index]\r\n            : options.fillColor\r\n          this._ctx.fill()\r\n        }\r\n      }\r\n    }\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawTrackPointsSvg: function (trackpoints) {\r\n    for (let i = 0, len = trackpoints.length; i < len; i++) {\r\n      if (trackpoints[i].isOrigin) {\r\n        let latLng = L.latLng(trackpoints[i].lat, trackpoints[i].lng)\r\n        let cricleMarker = L.circleMarker(latLng, this.trackPointOptions)\r\n        cricleMarker.bindTooltip(\r\n          this._getTooltipText(trackpoints[i]),\r\n          this.toolTipOptions\r\n        )\r\n        this._trackPointFeatureGroup.addLayer(cricleMarker)\r\n      }\r\n    }\r\n  },\r\n\r\n  _drawtxt: function (text, trackpoint) {\r\n    let point = this._getLayerPoint(trackpoint)\r\n    this._ctx.save()\r\n    this._ctx.font = '12px Verdana'\r\n    this._ctx.fillStyle = '#000'\r\n    this._ctx.textAlign = 'center'\r\n    this._ctx.textBaseline = 'bottom'\r\n    this._ctx.fillText(text, point.x, point.y - 12, 200)\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawShipCanvas: function (trackpoint, index = 0) {\r\n    let point = this._getLayerPoint(trackpoint)\r\n    let rotate = trackpoint.dir || 0\r\n    let w = this.targetOptions.width\r\n    let h = this.targetOptions.height\r\n    let dh = h / 3\r\n\r\n    this._ctx.save()\r\n    this._ctx.fillStyle = isArray(this.targetOptions.fillColor)\r\n      ? this.targetOptions.fillColor[index]\r\n      : this.targetOptions.fillColor\r\n    this._ctx.strokeStyle = isArray(this.targetOptions.color)\r\n      ? this.targetOptions.color[index]\r\n      : this.targetOptions.color\r\n    this._ctx.translate(point.x, point.y)\r\n    this._ctx.rotate((Math.PI / 180) * rotate)\r\n    this._ctx.beginPath()\r\n    this._ctx.moveTo(0, 0 - h / 2)\r\n    this._ctx.lineTo(0 - w / 2, 0 - h / 2 + dh)\r\n    this._ctx.lineTo(0 - w / 2, 0 + h / 2)\r\n    this._ctx.lineTo(0 + w / 2, 0 + h / 2)\r\n    this._ctx.lineTo(0 + w / 2, 0 - h / 2 + dh)\r\n    this._ctx.closePath()\r\n    this._ctx.fill()\r\n    this._ctx.stroke()\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawShipImage: function (trackpoint, index = 0) {\r\n    let point = this._getLayerPoint(trackpoint)\r\n    let dir = trackpoint.dir || 0\r\n    let width = this.targetOptions.width\r\n    let height = this.targetOptions.height\r\n    let offset = {\r\n      x: width / 2,\r\n      y: height / 2\r\n    }\r\n    this._ctx.save()\r\n    this._ctx.translate(point.x, point.y)\r\n    this._ctx.rotate((Math.PI / 180) * dir)\r\n    this._ctx.drawImage(\r\n      isArray(this._targetImg) ? this._targetImg[index] : this._targetImg,\r\n      0 - offset.x,\r\n      0 - offset.y,\r\n      width,\r\n      height\r\n    )\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _getTooltipText: function (targetobj) {\r\n    let content = []\r\n    content.push('<table>')\r\n    if (targetobj.info && targetobj.info.length) {\r\n      for (let i = 0, len = targetobj.info.length; i < len; i++) {\r\n        content.push('<tr>')\r\n        content.push('<td>' + targetobj.info[i].key + '</td>')\r\n        content.push('<td>' + targetobj.info[i].value + '</td>')\r\n        content.push('</tr>')\r\n      }\r\n    }\r\n    content.push('</table>')\r\n    content = content.join('')\r\n    return content\r\n  },\r\n\r\n  _clearLayer: function () {\r\n    let bounds = this._trackLayer.getBounds()\r\n    if (bounds) {\r\n      let size = bounds.getSize()\r\n      this._ctx.clearRect(bounds.min.x, bounds.min.y, size.x, size.y)\r\n    } else {\r\n      this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height)\r\n    }\r\n    if (this._map.hasLayer(this._trackPointFeatureGroup)) {\r\n      this._trackPointFeatureGroup.clearLayers()\r\n    }\r\n  },\r\n\r\n  _getLayerPoint (trackpoint) {\r\n    return this._map.latLngToLayerPoint(\r\n      L.latLng(trackpoint.lat, trackpoint.lng)\r\n    )\r\n  }\r\n})\r\n\r\nexport const draw = function (map, options) {\r\n  return new Draw(map, options)\r\n}\r\n","import L from 'leaflet'\r\n\r\nimport { Track } from './track'\r\nimport { TrackController } from './trackcontroller'\r\nimport { Clock } from './clock'\r\nimport { Draw } from './draw'\r\nimport * as Util from './util'\r\n\r\n/**\r\n * single track data\r\n * [{lat: 30, lng: 116, time: 1502529980, heading: 300, info:[]},{},....]\r\n *\r\n * mutiple track data\r\n * [single track data, single track data, single track data]\r\n */\r\nexport const TrackPlayBack = L.Class.extend({\r\n  includes: L.Evented.prototype || L.Mixin.Events,\r\n\r\n  initialize: function (data, map, options = {}) {\r\n    let drawOptions = {\r\n      trackPointOptions: options.trackPointOptions,\r\n      trackLineOptions: options.trackLineOptions,\r\n      targetOptions: options.targetOptions,\r\n      toolTipOptions: options.toolTipOptions\r\n    }\r\n    this.tracks = this._initTracks(data)\r\n    this.draw = new Draw(map, drawOptions)\r\n    this.trackController = new TrackController(this.tracks, this.draw)\r\n    this.clock = new Clock(this.trackController, options.clockOptions)\r\n\r\n    this.clock.on('tick', this._tick, this)\r\n  },\r\n  start: function () {\r\n    this.clock.start()\r\n    return this\r\n  },\r\n  stop: function () {\r\n    this.clock.stop()\r\n    return this\r\n  },\r\n  rePlaying: function () {\r\n    this.clock.rePlaying()\r\n    return this\r\n  },\r\n  slowSpeed: function () {\r\n    this.clock.slowSpeed()\r\n    return this\r\n  },\r\n  quickSpeed: function () {\r\n    this.clock.quickSpeed()\r\n    return this\r\n  },\r\n  getSpeed: function () {\r\n    return this.clock.getSpeed()\r\n  },\r\n  getCurTime: function () {\r\n    return this.clock.getCurTime()\r\n  },\r\n  getStartTime: function () {\r\n    return this.clock.getStartTime()\r\n  },\r\n  getEndTime: function () {\r\n    return this.clock.getEndTime()\r\n  },\r\n  isPlaying: function () {\r\n    return this.clock.isPlaying()\r\n  },\r\n  setCursor: function (time) {\r\n    this.clock.setCursor(time)\r\n    return this\r\n  },\r\n  setSpeed: function (speed) {\r\n    this.clock.setSpeed(speed)\r\n    return this\r\n  },\r\n  showTrackPoint: function () {\r\n    this.draw.showTrackPoint()\r\n    return this\r\n  },\r\n  hideTrackPoint: function () {\r\n    this.draw.hideTrackPoint()\r\n    return this\r\n  },\r\n  showTrackLine: function () {\r\n    this.draw.showTrackLine()\r\n    return this\r\n  },\r\n  hideTrackLine: function () {\r\n    this.draw.hideTrackLine()\r\n    return this\r\n  },\r\n  setVisibility: function (visibleIndexes) {\r\n    this.clock.setVisibility(visibleIndexes)\r\n    return this\r\n  },\r\n  dispose: function () {\r\n    this.clock.off('tick', this._tick)\r\n    this.draw.remove()\r\n    this.tracks = null\r\n    this.draw = null\r\n    this.trackController = null\r\n    this.clock = null\r\n  },\r\n  _tick: function (e) {\r\n    this.fire('tick', e)\r\n  },\r\n  _initTracks: function (data) {\r\n    let tracks = []\r\n    if (Util.isArray(data)) {\r\n      if (Util.isArray(data[0])) {\r\n        // 多条轨迹\r\n        for (let i = 0, len = data.length; i < len; i++) {\r\n          tracks.push(new Track(data[i]))\r\n        }\r\n      } else {\r\n        // 单条轨迹\r\n        tracks.push(new Track(data))\r\n      }\r\n    }\r\n    return tracks\r\n  }\r\n})\r\n\r\nexport const trackplayback = function (data, map, options) {\r\n  return new TrackPlayBack(data, map, options)\r\n}\r\n","import L from 'leaflet'\r\n\r\nimport {\r\n  TrackPlayBack,\r\n  trackplayback\r\n} from './trackplayback'\r\n\r\nL.TrackPlayBack = TrackPlayBack\r\nL.trackplayback = trackplayback\r\n"],"sourceRoot":""}